import sys, osimport mathfrom collections import defaultdict, deque, Counterfrom functools import lru_cachefrom bisect import bisect_right, bisect_leftRANDOM = int.from_bytes(os.urandom(8), "big")def getInt(): return int(sys.stdin.readline().strip())def getStr(): return sys.stdin.readline().strip()def getIntSeq(): return map(int, sys.stdin.readline().strip().split())def getStrSeq(): return sys.stdin.readline().strip().split()def getIntList(): return list(map(int, sys.stdin.readline().strip().split()))def getStrList(): return list(sys.stdin.readline().strip().split())  t = 1t = getInt()              def solve():    n = getInt()    l = getIntList()     dif = []     # dif.append(abs(l[0]-l[1]))     # for i in range(1, n-1):    #     dif.append( abs(l[i]- l[i+1]) + abs(l[i] - l[i-1]) )    # dif.append(abs(l[-1] - l[-2]))     ans = 0    for i in range(1, n):        ans += abs(l[i] - l[i-1])         # maxx = max(dif)    # print(maxx)     # if abs(l[0] - l[1]) == maxx or abs(l[-1] - l[-2]) == maxx:    #     print(ans - maxx)    #     return        # for i in range(1, n-1):    #     temp = abs(l[i]- l[i+1]) + abs(l[i] - l[i-1])    #     if temp == maxx:    #         rem = abs(l[i+1] - l[i-1])    #         print(ans - maxx + rem)    #         return      maxx = abs(l[0] - l[1])    maxx = max(abs(l[-1] - l[-2]), maxx)    summ = ans    ans = summ-maxx    # ans = min(temp, ans)    for i in range(1, n-1):        rem = abs(l[i] - l[i-1]) + abs(l[i] - l[i+1])        add = abs(l[i+1] - l[i-1])        temp = summ        temp += add        temp -= rem        ans = min(ans, temp)    print(ans)                                                                                                                                               for _ in range(t):    solve()